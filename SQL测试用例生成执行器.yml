app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: SQLæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆæ‰§è¡Œå™¨
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/siliconflow:0.0.15@775950e2071600bd3ba0415ec306c1b1582bc4a2a94688d642f627d112d87cd3
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        sourceType: start
        targetType: llm
      id: 1749708813685-llm
      source: '1749708813685'
      sourceHandle: source
      target: llm
      targetHandle: target
      type: custom
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: llm-source-1749711012003-target
      source: llm
      sourceHandle: source
      target: '1749711012003'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: iteration
      id: 1749711012003-source-1749711045565-target
      source: '1749711012003'
      sourceHandle: source
      target: '1749711045565'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1749711045565'
        sourceType: iteration-start
        targetType: code
      id: 1749711045565start-source-1749711085792-target
      source: 1749711045565start
      sourceHandle: source
      target: '1749711085792'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1749711045565'
        sourceType: code
        targetType: code
      id: 1749711085792-source-1749711131995-target
      source: '1749711085792'
      sourceHandle: source
      target: '1749711131995'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1749711045565'
        sourceType: code
        targetType: http-request
      id: 1749711131995-source-1749711177534-target
      source: '1749711131995'
      sourceHandle: source
      target: '1749711177534'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1749711045565'
        sourceType: http-request
        targetType: code
      id: 1749711177534-source-1749711369574-target
      source: '1749711177534'
      sourceHandle: source
      target: '1749711369574'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: iteration
        targetType: code
      id: 1749711045565-source-1749711470342-target
      source: '1749711045565'
      sourceHandle: source
      target: '1749711470342'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1749711470342-source-1749711520034-target
      source: '1749711470342'
      sourceHandle: source
      target: '1749711520034'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: answer
      id: 1749711520034-source-1749711603515-target
      source: '1749711520034'
      sourceHandle: source
      target: '1749711603515'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables: []
      height: 53
      id: '1749708813685'
      position:
        x: 30
        y: 413
      positionAbsolute:
        x: 30
        y: 413
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: false
            size: 10
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-72B-Instruct-128K
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: 4df40e38-d7b4-4381-929b-6d1526f0ced6
          role: system
          text: "ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½ SQL æµ‹è¯•ç”¨ä¾‹ç”ŸæˆåŠ©æ‰‹ã€‚è¯·æ ¹æ®ç”¨æˆ·æä¾›çš„æ•°æ®åº“è¡¨ç»“æ„ï¼Œç”Ÿæˆä¸€ç»„ SQL æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºæµ‹è¯•ç³»ç»Ÿå¯¹ SQL çš„å…¼å®¹æ€§å’Œå®‰å…¨æ€§ã€‚\n\
            \nè¯·éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š\n\n1. **ç†è§£è¡¨ç»“æ„**ï¼š\n   - è¡¨åã€å­—æ®µåã€å­—æ®µç±»å‹ã€çº¦æŸï¼ˆå¦‚ NOT NULLã€UNIQUEã€FOREIGN\
            \ KEYï¼‰ç­‰ä¿¡æ¯ã€‚\n   - è¯†åˆ«ä¸»é”®ã€å¤–é”®ã€ç´¢å¼•å­—æ®µï¼Œç”¨äºç”Ÿæˆ JOIN æˆ– WHERE æ¡ä»¶ã€‚\n\n2. **æé«˜æŸ¥è¯¢è¦†ç›–ç‡**ï¼š\n\
            \   - ç”Ÿæˆå¤šæ ·åŒ–çš„æŸ¥è¯¢ï¼Œè¦†ç›–å¸¸è§çš„ SQL æ“ä½œç±»å‹ï¼š\n     - ç®€å• SELECT æŸ¥è¯¢\n     - WHERE æ¡ä»¶ï¼ˆåŒ…æ‹¬å•æ¡ä»¶ã€å¤šæ¡ä»¶ã€INã€LIKEã€BETWEEN\
            \ ç­‰ï¼‰\n     - JOIN æ“ä½œï¼ˆINNER JOINã€LEFT JOIN ç­‰ï¼‰\n     - èšåˆå‡½æ•°ï¼ˆCOUNTã€SUMã€AVGã€MAXã€MINï¼‰\n\
            \     - GROUP BY + HAVING\n     - ORDER BYã€LIMITã€OFFSET\n     - å­æŸ¥è¯¢å’ŒåµŒå¥—æŸ¥è¯¢\n\
            \   - å°è¯•ç»„åˆå¤šä¸ªæ“ä½œï¼Œç”Ÿæˆå¤æ‚ä½†åˆç†çš„ SQLã€‚\n\n3. **ä¿è¯ SQL çš„å®‰å…¨æ€§ä¸åˆç†æ€§**ï¼š\n   - é¿å…ç”Ÿæˆéæ³• SQLï¼ˆå¦‚å­—æ®µåé”™è¯¯ã€è¡¨åä¸å­˜åœ¨ï¼‰\n\
            \   - ä¸å…è®¸å­—æ®µå€¼ä¸º NULL çš„å­—æ®µä½¿ç”¨ `IS NULL` æŸ¥è¯¢ï¼ˆé™¤éå­—æ®µå…è®¸ NULLï¼‰\n   - ä¸å…è®¸å°† `username`\
            \ æˆ–å…¶ä»–æ•æ„Ÿå­—æ®µè®¾ç½®ä¸ºå­—ç¬¦ä¸² `'null'`ï¼ˆé˜²æ­¢æ— æ•ˆæµ‹è¯•ï¼‰\n   - é¿å…ç”Ÿæˆå¯èƒ½å¼•å‘ SQL æ³¨å…¥çš„è¯­å¥ï¼ˆå¦‚ `'1'='1'`\
            \ ç­‰ï¼‰\n   - ç¡®ä¿å­—æ®µå€¼ç±»å‹åŒ¹é…ï¼ˆå¦‚æ•´æ•°å­—æ®µä¸ä½¿ç”¨å­—ç¬¦ä¸²æ¯”è¾ƒï¼‰\n\n4. **ä¼˜åŒ–ç”Ÿæˆä½“éªŒ**ï¼š\n   - ä½¿ç”¨çœŸå®ã€è´´è¿‘ç”¨æˆ·è¡Œä¸ºçš„å­—æ®µå€¼ï¼ˆå¦‚ç”¨æˆ·åä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼Œä¸ä¸ºéæ³•å€¼ï¼‰\n\
            \   - ç”Ÿæˆçš„ SQL åº”è¯¥æ¸…æ™°ã€å¯è¯»ã€å¯æµ‹è¯•\n   - å¦‚æœæœ‰ç¤ºä¾‹æ•°æ®ï¼Œå°½é‡è´´è¿‘ç¤ºä¾‹é€»è¾‘\n\n---\næˆ‘ä¼šç»™ä½ è¡¨ç»“æ„ã€‚\nè¯·ç”Ÿæˆ\
            \ 3 æ¡ SQL æŸ¥è¯¢è¯­å¥ï¼Œè¦†ç›–ä¸Šè¿°æåˆ°çš„å„ç§æ“ä½œï¼Œå¹¶ç¡®ä¿æ¯æ¡ SQL éƒ½æ»¡è¶³å­—æ®µçº¦æŸå’Œè¯­æ³•è§„åˆ™ã€‚\n### è¾“å‡ºè¦æ±‚\nç”¨jsonè¾“å‡ºæµ‹è¯•ç”¨ä¾‹äºŒç»´æ•°ç»„ï¼Œæµ‹è¯•ç”¨ä¾‹å¯¹è±¡å±æ€§åŒ…å«ï¼šæµ‹è¯•ç›®çš„(test_name)ã€sqlè¯­å¥(sql)ï¼Œä¸è¦```sqlæ ‡ç­¾ï¼Œä¸è¦```jsonæ ‡ç­¾ï¼Œç›´æ¥è¾“å‡ºjsonå†…å®¹ï¼Œä¸è¦æ¢è¡Œç¬¦ã€‚"
        - id: b01a1a22-44c1-48b0-a5cf-9d95a4334e1b
          role: user
          text: '### è¡¨ç»“æ„

            DROP TABLE IF EXISTS order_items;DROP TABLE IF EXISTS orders;DROP TABLE
            IF EXISTS products;DROP TABLE IF EXISTS customers;-- ------------------------------
            1. å®¢æˆ·è¡¨ (customers)-- ----------------------------CREATE TABLE `customers`
            (`id` INT AUTO_INCREMENT PRIMARY KEY,`name` VARCHAR(100) NOT NULL,`email`
            VARCHAR(100) NOT NULL UNIQUE,`phone` VARCHAR(20),`address` TEXT,`registration_date`
            TIMESTAMP DEFAULT CURRENT_TIMESTAMP) COMMENT=''å­˜å‚¨å®¢æˆ·åŸºæœ¬ä¿¡æ¯'';-- ------------------------------
            2. å•†å“è¡¨ (products)-- ----------------------------CREATE TABLE `products`
            (`id` INT AUTO_INCREMENT PRIMARY KEY,`name` VARCHAR(255) NOT NULL,`description`
            TEXT,`price` DECIMAL(10, 2) NOT NULL,`stock_quantity` INT NOT NULL DEFAULT
            0,`created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP) COMMENT=''å­˜å‚¨å•†å“ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä»·æ ¼å’Œåº“å­˜'';--
            ------------------------------ 3. è®¢å•è¡¨ (orders)-- ----------------------------CREATE
            TABLE `orders` (`id` INT AUTO_INCREMENT PRIMARY KEY,`customer_id` INT
            NOT NULL,`order_date` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,`status` ENUM(''pending'',
            ''processing'', ''shipped'', ''delivered'', ''cancelled'') NOT NULL DEFAULT
            ''pending'',`total_amount` DECIMAL(10, 2),FOREIGN KEY (`customer_id`)
            REFERENCES `customers`(`id`) ON DELETE RESTRICT) COMMENT=''å­˜å‚¨è®¢å•çš„æ€»ä½“ä¿¡æ¯å’ŒçŠ¶æ€'';--
            ------------------------------ 4. è®¢å•è¯¦æƒ…è¡¨ (order_items)-- ----------------------------CREATE
            TABLE `order_items` (`id` INT AUTO_INCREMENT PRIMARY KEY,`order_id` INT
            NOT NULL,`product_id` INT NOT NULL,`quantity` INT NOT NULL,`price_per_unit`
            DECIMAL(10, 2) NOT NULL,FOREIGN KEY (`order_id`) REFERENCES `orders`(`id`)
            ON DELETE CASCADE,FOREIGN KEY (`product_id`) REFERENCES `products`(`id`)
            ON DELETE RESTRICT) COMMENT=''è¿æ¥è®¢å•å’Œå•†å“ï¼Œè®°å½•æ¯ä¸ªè®¢å•åŒ…å«çš„å…·ä½“å•†å“å’Œæ•°é‡'';'
        - id: 55182037-51e3-4c6f-a274-8831e9d62937
          role: user
          text: '### æ•°ç»„ç»“æ„

            [{"test_name":"","sql":""},,,]'
        selected: false
        title: LLM
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: llm
      position:
        x: 334
        y: 413
      positionAbsolute:
        x: 334
        y: 413
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\nfunction main({arg1, arg2}) {\n    return {\n        result: JSON.parse(arg1)\n\
          \    }\n}\n"
        code_language: javascript
        desc: ''
        outputs:
          result:
            children: null
            type: array[object]
        selected: false
        title: ä»£ç æ‰§è¡Œ
        type: code
        variables:
        - value_selector:
          - llm
          - text
          variable: arg1
      height: 53
      id: '1749711012003'
      position:
        x: 638
        y: 413
      positionAbsolute:
        x: 638
        y: 413
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        error_handle_mode: continue-on-error
        height: 426
        is_parallel: true
        iterator_selector:
        - '1749711012003'
        - result
        output_selector:
        - '1749711369574'
        - result
        output_type: array[object]
        parallel_nums: 10
        selected: false
        start_node_id: 1749711045565start
        title: è¿­ä»£
        type: iteration
        width: 1420
      height: 426
      id: '1749711045565'
      position:
        x: 942
        y: 413
      positionAbsolute:
        x: 942
        y: 413
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 1420
      zIndex: 1
    - data:
        desc: ''
        isInIteration: true
        selected: false
        title: ''
        type: iteration-start
      draggable: false
      height: 48
      id: 1749711045565start
      parentId: '1749711045565'
      position:
        x: 60
        y: 105.5
      positionAbsolute:
        x: 1002
        y: 518.5
      selectable: false
      sourcePosition: right
      targetPosition: left
      type: custom-iteration-start
      width: 44
      zIndex: 1002
    - data:
        code: "\nfunction main({arg1, arg2}) {\n    return {\n        result: arg1.test_name\n\
          \    }\n}\n"
        code_language: javascript
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1749711045565'
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: ä»£ç æ‰§è¡Œ - å¤„ç†è¾“å…¥
        type: code
        variables:
        - value_selector:
          - '1749711045565'
          - item
          variable: arg1
      height: 53
      id: '1749711085792'
      parentId: '1749711045565'
      position:
        x: 204
        y: 103
      positionAbsolute:
        x: 1146
        y: 516
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        code: "\nfunction main({arg1, arg2}) {\n    return {\n        result: arg1.sql\n\
          \    }\n}\n"
        code_language: javascript
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1749711045565'
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: ä»£ç æ‰§è¡Œ - sql
        type: code
        variables:
        - value_selector:
          - '1749711045565'
          - item
          variable: arg1
      height: 53
      id: '1749711131995'
      parentId: '1749711045565'
      position:
        x: 508
        y: 103
      positionAbsolute:
        x: 1450
        y: 516
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        authorization:
          config: null
          type: no-auth
        body:
          data:
          - id: key-value-1508
            key: ''
            type: text
            value: '{"sql":"{{#1749711131995.result#}}"}'
          type: json
        desc: ''
        headers: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1749711045565'
        method: post
        params: ''
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 100
        selected: false
        ssl_verify: true
        timeout:
          max_connect_timeout: 0
          max_read_timeout: 0
          max_write_timeout: 0
        title: HTTP è¯·æ±‚
        type: http-request
        url: http://host.docker.internal:8000/api/test/execute
        variables: []
      height: 139
      id: '1749711177534'
      parentId: '1749711045565'
      position:
        x: 812
        y: 60
      positionAbsolute:
        x: 1754
        y: 473
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        code: "\nfunction main({arg1, arg2,sql}) {\n    return {\n        result:\
          \ {task_name:arg1,sql:sql,status:arg2}\n    }\n}\n"
        code_language: javascript
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1749711045565'
        outputs:
          result:
            children: null
            type: object
        selected: false
        title: ä»£ç æ‰§è¡Œ 4
        type: code
        variables:
        - value_selector:
          - '1749711085792'
          - result
          variable: arg1
        - value_selector:
          - '1749711177534'
          - body
          variable: arg2
        - value_selector:
          - '1749711131995'
          - result
          variable: sql
      height: 53
      id: '1749711369574'
      parentId: '1749711045565'
      position:
        x: 1116
        y: 103
      positionAbsolute:
        x: 2058
        y: 516
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
      zIndex: 1002
    - data:
        code: "\nfunction main({arg1, arg2}) {\n    return {\n        result: JSON.stringify(arg1)\n\
          \    }\n}\n"
        code_language: javascript
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: ä»£ç æ‰§è¡Œ 5
        type: code
        variables:
        - value_selector:
          - '1749711045565'
          - output
          variable: arg1
      height: 53
      id: '1749711470342'
      position:
        x: 2422
        y: 413
      positionAbsolute:
        x: 2422
        y: 413
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-72B-Instruct-128K
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: fb94ed57-7439-4dad-a568-cee7a513674d
          role: system
          text: æ ¹æ®ç»™ä½ çš„sqlæµ‹è¯•ç”¨ä¾‹ï¼Œç»™æˆ‘ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šï¼Œå¯ä»¥ç”¨è¡¨æ ¼çš„åœ°æ–¹ç”¨è¡¨æ ¼å±•ç¤ºã€‚
        - id: adc13792-06b8-4d83-90d5-5844184c1d27
          role: user
          text: '### æµ‹è¯•ç”¨ä¾‹æƒ…å†µ

            {{#1749711470342.result#}}'
        selected: false
        title: LLM 2
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: '1749711520034'
      position:
        x: 2726
        y: 413
      positionAbsolute:
        x: 2726
        y: 413
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1749711520034.text#}}'
        desc: ''
        selected: true
        title: ç›´æ¥å›å¤
        type: answer
        variables: []
      height: 104
      id: '1749711603515'
      position:
        x: 3030
        y: 413
      positionAbsolute:
        x: 3030
        y: 413
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -9.531547583270822
      y: 121.11618103751819
      zoom: 0.3341945613686457
